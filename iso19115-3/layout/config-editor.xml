<?xml version="1.0" encoding="UTF-8"?>
<editor xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:gn="http://www.fao.org/geonetwork"
        xmlns:srv="http://standards.iso.org/iso/19115/-3/srv/2.0"
        xmlns:mdb="http://standards.iso.org/iso/19115/-3/mdb/1.0"
        xmlns:mcc="http://standards.iso.org/iso/19115/-3/mcc/1.0"
        xmlns:mri="http://standards.iso.org/iso/19115/-3/mri/1.0"
        xmlns:mrl="http://standards.iso.org/iso/19115/-3/mrl/1.0"
        xmlns:mrs="http://standards.iso.org/iso/19115/-3/mrs/1.0"
        xmlns:mrd="http://standards.iso.org/iso/19115/-3/mrd/1.0"
        xmlns:mco="http://standards.iso.org/iso/19115/-3/mco/1.0"
        xmlns:msr="http://standards.iso.org/iso/19115/-3/msr/1.0"
        xmlns:lan="http://standards.iso.org/iso/19115/-3/lan/1.0"
        xmlns:gcx="http://standards.iso.org/iso/19115/-3/gcx/1.0"
        xmlns:gex="http://standards.iso.org/iso/19115/-3/gex/1.0"
        xmlns:mdq="http://standards.iso.org/iso/19157/-2/mdq/1.0"
        xmlns:cit="http://standards.iso.org/iso/19115/-3/cit/1.0"
        xmlns:gco="http://standards.iso.org/iso/19115/-3/gco/1.0"
        xmlns:gml="http://www.opengis.net/gml/3.2"
        xsi:noNamespaceSchemaLocation="../../config-editor.xsd">

  <!-- TODO: Fix tooltip= - should use the name of an element from the labels.xml file -->

  <!-- Form field type configuration. Default is text. -->
  <fields>
      <for name="mri:abstract" use="textarea"/>
      <for name="mri:credit" use="textarea"/>
      <for name="cit:description" use="textarea"/>
      <for name="mdq:evaluationMethodDescription" use="textarea"/>
      <for name="mdq:explanation" use="textarea"/>
      <for name="mco:handlingDescription" use="textarea"/>
      <for name="mmi:maintenanceNote" use="textarea"/>
      <for name="mdq:measureDescription" use="textarea"/>
      <for name="mri:purpose" use="textarea"/>
      <for name="mrd:orderingInstructions" use="textarea"/>
      <for name="mco:otherConstraints" use="textarea"/>
      <for name="mrl:description" use="textarea"/>
      <for name="mrd:description" use="textarea"/>
      <for name="mrl:statement" use="textarea"/>
      <for name="mri:supplementalInformation" use="textarea"/>
      <for name="mri:specificUsage" use="textarea"/>
      <for name="mco:useLimitation" use="textarea"/>
      <for name="mri:levelOfDetail" use="textarea"/>
      <for name="mco:statement" use="textarea"/>
      <for name="mco:userNote" use="textarea"/>


      <for name="gco:Distance" use="number"/>
      <for name="gco:Decimal" use="number"/>
      <for name="gco:Integer" use="number"/>
      <for name="gco:Angle" use="number"/>
      <for name="gco:Boolean" use="checkbox"/>

    <!-- NOTE: for directiveAttributes on gco:Date/gco:DateTime refer to iso19115-3/layout/layout.xsl -->
    <for name="gco:Date" use="data-gn-date-picker"/> 
    <for name="gco:DateTime" use="data-gn-date-picker"/>



      <!-- gmx:FileName/@src attribute -->
    <for name="src" use="data-gn-logo-selector"/>

    <for name="cit:electronicMailAddress" use="email"/>

    <for name="lan:language" use="data-gn-language-picker"/>
    <for name="lan:languageCode" use="data-gn-language-picker"/>

    <for name="lan:country" use="data-gn-country-picker"/>
    <for name="cit:country" use="data-gn-country-picker"/>

    <for name="mdb:referenceSystemInfo" addDirective="data-gn-crs-selector">
         <directiveAttributes data-schema="iso19115-3"/>
    </for>

    <!-- Probably don't need to use the organisation-entry-selector - instead use the directory-entry-selector
         without a data-variables attribute and filter on both cit:CI_Organisation and cit:CI_Individual -->
    <for name="cit:party" addDirective="data-gn-organisation-entry-selector">
        <directiveAttributes data-schema="iso19115-3"
                             data-root="cit:CI_Individual or cit:CI_Organisation"/>
    </for>
    
<!--    
    <for name="mdb:contact" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="false"
                              data-template-type="contact"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Organisation or cit:CI_Individual&#34;}"
                              data-variables=""/>
    </for>
    <for name="mri:pointOfContact" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="true"
                              data-template-type="contact"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Organisation or cit:CI_Individual&#34;}"
                              data-variables=""/>
    </for>
    <for name="mco:addressee" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="true"
                              data-template-type="contact"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Organisation or cit:CI_Individual&#34;}"
                              data-variables=""/>
    </for>
-->
    <for name="mco:reference" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="true"
                              data-template-type="license"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Citation&#34;}"
                              data-variables=""/>
    </for>
<!--
    <for name="mrd:distributorContact" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="true"
                              data-template-type="contact"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Organisation or cit:CI_Individual&#34;}"
                              data-variables=""/>
    </for>
    <for name="cit:citedResponsibleParty" addDirective="data-gn-directory-entry-selector">
         <directiveAttributes data-schema="iso19115-3" data-template-add-action="true"
                              data-template-type="contact"
                              data-filter="{&#34;_root&#34;: &#34;cit:CI_Organisation or cit:CI_Individual&#34;}"
                              data-variables=""/>
    </for>
-->

    <for name="mri:descriptiveKeywords" addDirective="data-gn-thesaurus-selector">
         <directiveAttributes data-transformation="to-iso19115-3-keyword"/>
    </for>

    <for name="gex:geographicIdentifier" addDirective="data-gn-thesaurus-selector">
         <directiveAttributes data-transformation="to-iso19115-3-identifier"
                              data-thesaurus-type="place"/> 
    </for>
  </fields>


  <fieldsWithFieldset>
      <name>mdb:metadataLinkage</name>
      <name>mdb:identificationInfo</name>
      <name>mdb:distributionInfo</name>
      <name>mri:descriptiveKeywords</name>
      <name>mri:thesaurusName</name>
      <name>mdb:spatialRepresentationInfo</name>
      <name>mri:pointOfContact</name>
      <name>mdb:contact</name>
      <name>mdb:dataQualityInfo</name>
      <name>mdb:resourceLineage</name>
      <name>cit:citedResponsibleParty</name>
      <name>cit:party</name>
      <name>cit:individual</name>
      <name>cit:logo</name>
      <name>mrd:onLine</name>
      <name>mdb:referenceSystemInfo</name>
      <name>mri:equivalentScale</name>
      <name>mri:graphicOverview</name>
      <name>mri:resourceConstraints</name>
      <name>msr:projection</name>
      <name>mdb:extent</name>
      <name>cit:extent</name>
      <name>gex:geographicBox</name>
      <name>gex:EX_TemporalExtent</name>
      <name>mrd:distributorContact</name>
      <name>mrd:distributionFormat</name>
      <name>srv:containsOperations</name>
      <name>srv:SV_CoupledResource</name>
      <name>mdb:metadataConstraints</name>
      <name>mdb:metadataStandard</name>
      <name>mdb:metadataProfile</name>
      <name>mdb:metadataScope</name>
      <name>mri:associatedResource</name>
      <name>mrl:source</name>
      <name>srv:parameter</name>
      <name>mco:releasability</name>
      <name>gex:geographicIdentifier</name>
      <name>msr:axisDimensionProperties</name>
      <name>msr:geometricObjects</name>
      <name>mco:reference</name>
      <name>mco:addressee</name>
      <name>cit:series</name>
      <name>cit:contactInfo</name>
      <name>mrd:distributorTransferOptions</name>
      <name>cit:telephone</name>
      <name>cit:address</name>
      <name>cit:onlineResource</name>
  </fieldsWithFieldset>

  <fieldsWithAttributes>
      <name>gco:Distance</name>
      <name>gco:Measure</name>
  </fieldsWithAttributes>

  <multilingualFields>
    <!-- In multilingual mode, define which mode
    the widget should have. If expanded, then one
    field per language is displayed. -->
    <expanded>
         <name>cit:title</name>
         <name>cit:abstract</name>
      </expanded>
      <!-- All fields in ISO could be multilingual.
    Define element to exlcude. 
    TODO: it may be relevant to have parent defined
    to restrict the list.
    -->
    <exclude>
    </exclude>
  </multilingualFields>


  <!-- View configuration -->
  <views>
      <view name="default"
            displayIfRecord="count(mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/mdb:resourceScope/mcc:MD_ScopeCode[@codeListValue='service']) = 0">


<!-- TAB 1 -->
         <tab id="resourceIdentification" default="true" mode="flat">
            <section name=" ">
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:title"/>
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:alternateTitle"
                       or="alternateTitle"
                       in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/>
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:date"
                      or="date"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/>
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:edition"
                      or="edition"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/> 
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:editionDate"
                       or="editionDate"
                       in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/> 
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:series"/>
										<action type="add" name="series"  forceLabel="true"
                       or="series"
                       in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"> 
                        <template>
                            <snippet>
                               <cit:series>
                                   <cit:CI_Series>
                                      <cit:name>
                                         <gco:CharacterString/>
                                      </cit:name>
                                      <cit:issueIdentification>
                                         <gco:CharacterString/>
                                      </cit:issueIdentification>
                                      <cit:page>
                                         <gco:CharacterString/>
                                      </cit:page>
                                   </cit:CI_Series>
                               </cit:series>
                            </snippet>
                        </template>
                    </action>
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:ISBN"
                       or="ISBN"
                       in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/> 
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:ISSN"
                       or="ISSN"
                       in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation"/> 

               <!-- Product Type: TODO: Do we want to add one with a default of dataset? -->
               <field xpath="/mdb:MD_Metadata/mdb:metadataScope" in="/mdb:MD_Metadata"/>
                    <action type="add" name="metadataScope" or="metadataScope" 
                            in="/mdb:MD_Metadata" forceLabel="true">
                        <template>
                            <snippet>
                            <mdb:metadataScope>
                                <mdb:MD_MetadataScope>
                                    <mdb:resourceScope>
                                 <mcc:MD_ScopeCode codeList="codeListLocation#MD_ScopeCode" codeListValue="dataset"/>
                              </mdb:resourceScope>
                                    <mdb:name>
                                 <gco:CharacterString/>
                              </mdb:name>
                                </mdb:MD_MetadataScope>
                            </mdb:metadataScope>
                            </snippet>
                        </template>
                    </action>
            </section>
         </tab>

<!-- TAB 2 -->
         <tab id="resourceDescription" mode="flat">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:abstract"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:purpose"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:credit"
                      or="credit"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:status"
                      or="status"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:graphicOverview"/>
                   <action type="add" name="graphicOverview" or="graphicOverview" forceLabel="true"
                           in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                            <snippet>
                                <mri:graphicOverview>
                                   <mcc:BrowseGraphic>
                                      <mcc:linkage>
                                         <cit:CI_OnlineResource>
                                            <cit:linkage>
                                               <gco:CharacterString></gco:CharacterString>
                                            </cit:linkage>
                                             <cit:name>
                                               <gco:CharacterString/>
                                             </cit:name>
                                             <cit:description>
                                               <gco:CharacterString></gco:CharacterString>
                                             </cit:description>
                                         </cit:CI_OnlineResource>
                                      </mcc:linkage>
                                   </mcc:BrowseGraphic>
                                </mri:graphicOverview>
                            </snippet>
                        </template>
                    </action>
            </section>
         </tab>

<!-- TAB 3 -->
         <tab id="responsibilities" mode="flat">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:pointOfContact"/>
                  <action type="add" name="resourceContactInfo" forceLabel="true"
                      or="pointOfContact"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                      <template>
                        <snippet>
                          <mri:pointOfContact>
                            <cit:CI_Responsibility>
                              <cit:role>
                                <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode" codeListValue=""/>
                              </cit:role>
                            </cit:CI_Responsibility>
                          </mri:pointOfContact>
                        </snippet>
                      </template>
                    </action>
                <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation/cit:citedResponsibleParty"/>
                  <action type="add" name="responsibility" forceLabel="true"
                      or="citedResponsibleParty"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:citation/cit:CI_Citation">
                      <template>
                        <snippet>
                          <cit:citedResponsibleParty>
                            <cit:CI_Responsibility>
                              <cit:role>
                                <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode" codeListValue=""/>
                              </cit:role>
                            </cit:CI_Responsibility>
                          </cit:citedResponsibleParty>
                        </snippet>
                      </template>
                    </action>
            </section>
         </tab>

<!-- TAB 4 -->
         <tab id="product" mode="flat">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:distributionInfo"/>
               <action type="add" name="productWithFormat" or="distributionInfo" in="/mdb:MD_Metadata"
                       forceLabel="true">
                    <template>
                       <snippet>
                         <mdb:distributionInfo>
                           <mrd:MD_Distribution>
                           <mrd:description>
                              <gco:CharacterString></gco:CharacterString>
                           </mrd:description>
                           <mrd:distributionFormat>
                               <mrd:MD_Format>
                                  <mrd:formatSpecificationCitation>
                                       <cit:CI_Citation>
                                           <cit:title>
                                               <gco:CharacterString></gco:CharacterString>
                                           </cit:title>
                                           <cit:edition>
                                               <gco:CharacterString></gco:CharacterString>
                                           </cit:edition>
                                           <cit:editionDate>
                                               <gco:Date></gco:Date>
                                           </cit:editionDate>
                                       </cit:CI_Citation>
                                  </mrd:formatSpecificationCitation>
                                  <mrd:formatDistributor>
                                     <mrd:MD_Distributor>
                                       <mrd:distributorContact>
                                         <cit:CI_Responsibility>
                                           <cit:role>
                                             <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode" codeListValue="distributor">distributor</cit:CI_RoleCode>
                                           </cit:role>
                                         </cit:CI_Responsibility>
                                       </mrd:distributorContact>
                                       <mrd:distributorTransferOptions>
                                         <mrd:MD_DigitalTransferOptions>
                                           <mrd:transferSize>
                                              <gco:Real/>
                                           </mrd:transferSize>
                                           <mrd:onLine>
                                             <cit:CI_OnlineResource>
                                               <cit:linkage>
                                                 <gco:CharacterString></gco:CharacterString>
                                               </cit:linkage>
                                               <cit:protocol>
                                                 <gco:CharacterString></gco:CharacterString>
                                               </cit:protocol>
                                               <cit:name>
                                                 <gco:CharacterString/>
                                               </cit:name>
                                               <cit:function>
                                                 <cit:CI_OnLineFunctionCode codeList="codeListLocation#cit:CI_OnLineFunctionCode" codeListValue=""/>
                                               </cit:function>
                                               <cit:description>
                                                 <gco:CharacterString></gco:CharacterString>
                                               </cit:description>
                                             </cit:CI_OnlineResource>
                                           </mrd:onLine>
                                         </mrd:MD_DigitalTransferOptions>
                                       </mrd:distributorTransferOptions>
                                     </mrd:MD_Distributor>
                                  </mrd:formatDistributor>
                               </mrd:MD_Format>
                           </mrd:distributionFormat>
                           </mrd:MD_Distribution>
                         </mdb:distributionInfo>
                     </snippet>
                 </template>
             </action>
          </section>
        </tab>

<!-- TAB 5 -->
         <tab id="resourceKeywords" mode="flat">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:topicCategory"
                      or="topicCategory"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:descriptiveKeywords"
                      or="descriptiveKeywords"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification"/>
            </section>
         </tab>

<!-- TAB 6 -->
         <tab id="constraints" mode="flat">
             <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:resourceConstraints/mco:MD_Constraints/mco:releasability" del="../.."/>
                    <action type="add" name="releasability" or="resourceConstraints"  forceLabel="true"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                           <!-- exclude mco:addressee from snippet and add mco:addressee as a flat
                                mode exception - directive will then be used to select addressee -->
                           <snippet>
                             <mri:resourceConstraints> 
                               <mco:MD_Constraints>
                                 <mco:releasability>
                                   <mco:MD_Releasability>
                                     <mco:statement>
                                       <gco:CharacterString/>
                                     </mco:statement>
                                     <mco:disseminationConstraints>
                                       <mco:MD_RestrictionCode codeList="codeListLocation#MD_RestrictionCode" codeListValue=""/>
                                     </mco:disseminationConstraints>
                                   </mco:MD_Releasability>
                                </mco:releasability>
                               </mco:MD_Constraints>
                             </mri:resourceConstraints> 
                           </snippet>
                        </template>
                    </action>
             </section>
             <section name=" ">
               <field name="legalConstraints" xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:resourceConstraints[mco:MD_LegalConstraints]"/>
                    <action type="add" name="legalConstraints" forceLabel="true"
                            or="resourceConstraints"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                           <!-- exclude mco:reference from snippet and add mco:reference as a flat
                                mode exception - directive will then be used to select reference -->
                           <snippet>
	                           <mri:resourceConstraints>
                               <mco:MD_LegalConstraints>
                                  <mco:useLimitation>
                                     <gco:CharacterString/>
                                  </mco:useLimitation>
                               </mco:MD_LegalConstraints>
                             </mri:resourceConstraints>
                           </snippet>
                        </template>
                    </action>
             </section>
             <section name=" ">
               <field name="securityConstraints" xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:resourceConstraints[mco:MD_SecurityConstraints]"/>
                    <action type="add" name="securityConstraints" forceLabel="true"
                            or="resourceConstraints"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                           <snippet>
                            <mri:resourceConstraints>
                               <mco:MD_SecurityConstraints>
                                  <mco:classification>
                                     <mco:MD_ClassificationCode codeList="codeListLocation#MD_ClassificationCode" codeListValue=""/>
                                  </mco:classification>
                                  <mco:userNote>
                                     <gco:CharacterString/>
                                  </mco:userNote>
                                  <mco:handlingDescription>
                                     <gco:CharacterString/>
                                  </mco:handlingDescription>
                               </mco:MD_SecurityConstraints>
                            </mri:resourceConstraints>
                           </snippet>
                        </template>
                    </action>
             </section>
         </tab>

<!-- TAB 7 -->
         <tab id="provenance" mode="flat">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:resourceLineage/mrl:LI_Lineage/mrl:statement"/>
               <field xpath="/mdb:MD_Metadata/mdb:resourceLineage/mrl:LI_Lineage/mrl:source"/>
                    <action type="add" name="source" or="source"  forceLabel="true"
                       in="/mdb:MD_Metadata/mdb:resourceLineage/mrl:LI_Lineage">
                        <template>
                            <snippet>
                            <mrl:source>
                                <mrl:LI_Source>
                                  <mrl:description>
                                    <gco:CharacterString/>
                                  </mrl:description>
                                </mrl:LI_Source>
                            </mrl:source>
                            </snippet>
                        </template>
                    </action>
            </section>
         </tab>

<!-- TAB 8 -->
         <tab id="resourceExtents" mode="flat">
            <section name="gex:geographicIdentifier">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:extent/gex:EX_Extent/gex:geographicElement/gex:EX_GeographicDescription/gex:geographicIdentifier"
                      or="geographicIdentifier"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:extent/gex:EX_Extent/gex:geographicElement/gex:EX_GeographicDescription"
                      del="../../../.."/>
                    <action type="add" name="geographicIdentifier" or="extent" forceLabel="true"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                            <snippet>
                               <mri:extent>
                                  <gex:EX_Extent>
                                     <gex:geographicElement>
                                        <gex:EX_GeographicDescription>
                                        </gex:EX_GeographicDescription>
                                     </gex:geographicElement>
                                  </gex:EX_Extent>
                               </mri:extent>
                            </snippet>
                        </template>
                    </action>
            </section>

            <section name=" ">
                     
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:extent/gex:EX_Extent/gex:geographicElement/gex:EX_GeographicBoundingBox" del="../../.."/>
                    <action type="add" name="geographicBoundingBox" or="extent" forceLabel="true"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                            <snippet>
                               <mri:extent>
                                  <gex:EX_Extent>
                                     <gex:geographicElement>
                                        <gex:EX_GeographicBoundingBox>
                                           <gex:westBoundLongitude>
                                              <gco:Decimal>-180</gco:Decimal>
                                           </gex:westBoundLongitude>
                                           <gex:eastBoundLongitude>
                                              <gco:Decimal>180</gco:Decimal>
                                           </gex:eastBoundLongitude>
                                           <gex:southBoundLatitude>
                                              <gco:Decimal>-90</gco:Decimal>
                                           </gex:southBoundLatitude>
                                           <gex:northBoundLatitude>
                                              <gco:Decimal>90</gco:Decimal>
                                           </gex:northBoundLatitude>
                                        </gex:EX_GeographicBoundingBox>
                                     </gex:geographicElement>
                                  </gex:EX_Extent>
                               </mri:extent>
                            </snippet>
                        </template>
                    </action>
                  
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:extent/gex:EX_Extent/gex:temporalElement/gex:EX_TemporalExtent" del="../../.."/>
                    <action type="add" name="temporalExtent" or="extent" forceLabel="true"
                            in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                        <template>
                            <snippet>
                               <mri:extent>
                                  <gex:EX_Extent>
                                     <gex:temporalElement>
                                       <gex:EX_TemporalExtent>
                                          <gex:extent>
                                             <gml:TimePeriod gml:id="">
                                                <gml:beginPosition/>
                                                <gml:endPosition/>
                                             </gml:TimePeriod>
                                          </gex:extent>
                                       </gex:EX_TemporalExtent>
                                    </gex:temporalElement>
                                  </gex:EX_Extent>
                               </mri:extent>
                            </snippet>
                        </template>
                    </action>

            </section>
         </tab>

<!-- TAB 9 -->
         <tab id="resourceSpatial" mode="flat"
              displayIfRecord="count(mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/mdb:resourceScope/mcc:MD_ScopeCode[@codeListValue=('','dataset','series','attribute','feature','tile','repository','aggregate','product','coverage')]) &gt; 0">
            <section name=" ">
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:spatialResolution"/>
                  <action type="add" name="addSpatialResolution" forceLabel="true"
                          or="spatialResolution"
                          in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification">
                     <template>
                        <snippet>
                           <mri:spatialResolution>
                             <mri:MD_Resolution>
                               <mri:distance>
                                 <gco:Distance uom="metres"/>
                               </mri:distance>
                             </mri:MD_Resolution>
                           </mri:spatialResolution>
                        </snippet>
                     </template>
                  </action>
               <field xpath="/mdb:MD_Metadata/mdb:referenceSystemInfo" 
                      or="referenceSystemInfo" 
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:spatialRepresentationType"
                      or="spatialRepresentationType"
                      in="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification"/>
               <text ref="saveAndContinue" if="count(mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation) = 0 and count(mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation) = 0"/>
            </section>
            <section name="msr:MD_GridSpatialRepresentation" if="count(mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:spatialRepresentationType/mcc:MD_SpatialRepresentationTypeCode[@codeListValue='grid']) > 0">
                  <action type="add" name="addGridSpatialRepresentation" forceLabel="true"
                          or="spatialRepresentationInfo"
                          in="/mdb:MD_Metadata">
<!--
                          if="count(mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation) = 0">
-->
                      <template>
                         <snippet>
                            <mdb:spatialRepresentationInfo>
                               <msr:MD_GridSpatialRepresentation>
                                 <msr:numberOfDimensions> 
                                   <gco:Integer></gco:Integer>
                                 </msr:numberOfDimensions> 
                               </msr:MD_GridSpatialRepresentation>
                            </mdb:spatialRepresentationInfo>
                         </snippet>
                      </template>
                  </action>

                  <field xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation/msr:numberOfDimensions" 
                         or="numberOfDimensions" 
                         in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation"/>
                  <field xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation/msr:axisDimensionProperties" 
                         in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation"/>
                     <action type="add" name="axisDimensionProperties" forceLabel="true"
                             or="axisDimensionProperties"
                             in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_GridSpatialRepresentation">
                        <template>
                            <snippet>
                               <msr:axisDimensionProperties>
                                  <msr:MD_Dimension>
                                     <msr:dimensionName>
                                        <msr:MD_DimensionNameTypeCode codeList="codeListLocation#MD_DimensionNameTypeCode" codeListValue=""/>
                                     </msr:dimensionName>
                                     <msr:dimensionSize>
                                        <gco:Integer></gco:Integer>
                                     </msr:dimensionSize>
                                     <msr:resolution>
                                        <gco:Measure uom="degrees"></gco:Measure>
                                     </msr:resolution>
                                  </msr:MD_Dimension>
                               </msr:axisDimensionProperties>
                            </snippet>
                        </template>

                     </action>
            </section>
            <section name="msr:MD_VectorSpatialRepresentation" if="count(mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:spatialRepresentationType/mcc:MD_SpatialRepresentationTypeCode[@codeListValue='vector']) > 0">
                  <action type="add" name="addVectorSpatialRepresentation" forceLabel="true"
                          or="spatialRepresentationInfo"
                          in="/mdb:MD_Metadata">
<!--
                          if="count(mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation) = 0">
-->
                      <template>
                         <snippet>
                            <mdb:spatialRepresentationInfo>
                               <msr:MD_VectorSpatialRepresentation>
                                 <msr:topologyLevel> 
                                   <msr:MD_TopologyLevelCode codeList="codeListLocation#MD_TopologyLevelCode" codeListValue=""/>
                                 </msr:topologyLevel> 
                               </msr:MD_VectorSpatialRepresentation>
                            </mdb:spatialRepresentationInfo>
                         </snippet>
                      </template>
                  </action>

                  <field xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation/msr:topologyLevel" 
                         or="topologyLevel" 
                         in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation"/>
                  <field xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation/msr:geometricObjects" 
                         in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation"/>
                     <action type="add" name="geometricObjects" forceLabel="true"
                             or="geometricObjects"
                             in="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_VectorSpatialRepresentation">
                        <template>
                            <snippet>
                               <msr:geometricObjects>
                                  <msr:MD_GeometricObjects>
                                     <msr:geometricObjectType>
                                        <msr:MD_GeometricObjectTypeCode codeList="codeListLocation#MD_GeometricObjectTypeCode" codeListValue=""/>
                                     </msr:geometricObjectType>
                                     <msr:geometricObjectCount>
                                        <gco:Integer></gco:Integer>
                                     </msr:geometricObjectCount>
                                  </msr:MD_GeometricObjects>
                               </msr:geometricObjects>
                            </snippet>
                        </template>
                     </action>
            </section>
         </tab>


<!-- TAB 10 -->
         <tab id="metadataInfo" mode="flat">
             <section name=" ">
                <text ref="useAssociatedResourcesForParentMetadata"/>
                <field xpath="/mdb:MD_Metadata/mdb:contact" or="contact" in="/mdb:MD_Metadata"/>
             </section>
             <section name=" ">
                  <field name="metadataReleasability" xpath="/mdb:MD_Metadata/mdb:metadataConstraints/mco:MD_Constraints/mco:releasability" del="../.."/>
                    <action type="add" name="metadataReleasability" or="metadataConstraints"  forceLabel="true"
                            in="/mdb:MD_Metadata">
                        <template>
                           <!-- exclude mco:addressee from snippet and add mco:addressee as a flat
                                mode exception - directive will then be used to select addressee -->
                           <snippet>
                             <mdb:metadataConstraints> 
                               <mco:MD_Constraints>
                                 <mco:releasability>
                                   <mco:MD_Releasability>
                                     <mco:statement>
                                       <gco:CharacterString/>
                                     </mco:statement>
                                     <mco:disseminationConstraints>
                                       <mco:MD_RestrictionCode codeList="codeListLocation#MD_RestrictionCode" codeListValue=""/>
                                     </mco:disseminationConstraints>
                                   </mco:MD_Releasability>
                                </mco:releasability>
                               </mco:MD_Constraints>
                             </mdb:metadataConstraints> 
                           </snippet>
                        </template>
                    </action>
             </section>
             <section name=" ">
                  <field name="metadataLegalConstraints" xpath="/mdb:MD_Metadata/mdb:metadataConstraints[mco:MD_LegalConstraints]"/>
                    <action type="add" name="metadataLegalConstraints" forceLabel="true"
                            or="metadataConstraints"
                            in="/mdb:MD_Metadata">
                        <template>
                           <!-- exclude mco:reference from snippet and add mco:reference as a flat
                                mode exception - directive will then be used to select reference -->
                           <snippet>
	                           <mdb:metadataConstraints>
                               <mco:MD_LegalConstraints>
                                  <mco:useLimitation>
                                     <gco:CharacterString/>
                                  </mco:useLimitation>
                               </mco:MD_LegalConstraints>
                             </mdb:metadataConstraints>
                           </snippet>
                        </template>
                    </action>
             </section>
             <section name=" ">
                  <field name="metadataSecurityConstraints" xpath="/mdb:MD_Metadata/mdb:metadataConstraints[mco:MD_SecurityConstraints]"/>
                    <action type="add" name="metadataSecurityConstraints" forceLabel="true"
                            or="metadataConstraints"
                            in="/mdb:MD_Metadata">
                        <template>
                           <snippet>
                            <mdb:metadataConstraints>
                               <mco:MD_SecurityConstraints>
                                  <mco:classification>
                                     <mco:MD_ClassificationCode codeList="codeListLocation#MD_ClassificationCode" codeListValue=""/>
                                  </mco:classification>
                                  <mco:userNote>
                                     <gco:CharacterString/>
                                  </mco:userNote>
                                  <mco:handlingDescription>
                                     <gco:CharacterString/>
                                  </mco:handlingDescription>
                               </mco:MD_SecurityConstraints>
                            </mdb:metadataConstraints>
                           </snippet>
                        </template>
                    </action>
             </section>
         </tab>

      <!-- Elements that should not use the "flat" mode -->
      <flatModeExceptions>
            <for name="mri:descriptiveKeywords"/>
            <for name="mrs:referenceSystemIdentifier"/>
            <for name="mrs:referenceSystemType"/>
            <for name="mri:keyword"/>
            <for name="cit:party"/>
            <for name="cit:CI_Individual"/>
            <for name="cit:CI_Organisation"/>
            <for name="mrl:LI_Lineage"/>
            <for name="mrd:distributorContact"/>
            <for name="mrd:distributorTransferOptions"/>
            <for name="mco:addressee"/>
            <for name="mco:reference"     context="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:resourceConstraints/mco:MD_LegalConstraints"/>
            <for name="mco:useLimitation" context="/mdb:MD_Metadata/mdb:identificationInfo/mri:MD_DataIdentification/mri:resourceConstraints/mco:MD_LegalConstraints"/>
            <for name="gex:geographicIdentifier"/>
            <for name="msr:dimensionTitle"/>
            <for name="msr:dimensionDescription"/>
            <for name="mrd:transferSize"/>
            <for name="mcc:code"/>
      </flatModeExceptions>
    </view>

    <view name="advanced"
            displayIfServiceInfo="count(session[profile='Administrator'])=1">
         <tab id="identificationInfo" default="true">
            <section xpath="/mdb:MD_Metadata/mdb:identificationInfo" or="identificationInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="distributionInfo">
            <section xpath="/mdb:MD_Metadata/mdb:distributionInfo" or="distributionInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="dataQualityInfo">
            <section xpath="/mdb:MD_Metadata/mdb:dataQualityInfo" or="dataQualityInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="resourceLineage">
            <section xpath="/mdb:MD_Metadata/mdb:resourceLineage" or="resourceLineage"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="spatialRepresentationInfo">
            <section xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo"
                     or="spatialRepresentationInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="referenceSystemInfo">
            <section xpath="/mdb:MD_Metadata/mdb:referenceSystemInfo" or="referenceSystemInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="contentInfo" toggle="true">
            <section xpath="/mdb:MD_Metadata/mdb:contentInfo" or="contentInfo" in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="acquisitionInformation" toggle="true">
            <section xpath="/mdb:MD_Metadata/mdb:acquisitionInformation" or="acquisitionInformation"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="metadata">
            <section name="mdb:MD_Metadata">
               <field xpath="/mdb:MD_Metadata/mdb:metadataIdentifier"/>
               <field xpath="/mdb:MD_Metadata/mdb:defaultLocale" or="defaultLocale"
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:otherLocale" or="otherLocale" in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:contact" or="contact" in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:parentMetadata" or="parentMetadata"
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:metadataScope" or="metadataScope"
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:alternativeMetadataReference"
                      or="alternativeMetadataReference"
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:metadataLinkage" or="metadataLinkage"
                      in="/mdb:MD_Metadata"/>
               <field xpath="/mdb:MD_Metadata/mdb:dateInfo"/>
               <field xpath="/mdb:MD_Metadata/mdb:metadataStandard"/>
               <field xpath="/mdb:MD_Metadata/mdb:metadataProfile"/>
            </section>
         </tab>
         <tab id="metadataConstraints" toggle="true">
            <section xpath="/mdb:MD_Metadata/mdb:metadataConstraints" or="metadataConstraints"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="metadataMaintenance" toggle="true">
            <section xpath="/mdb:MD_Metadata/mdb:metadataMaintenance" or="metadataMaintenance"
                     in="/mdb:MD_Metadata"/>
         </tab>
         <tab id="applicationSchemaInfo" toggle="true">
            <section xpath="/mdb:MD_Metadata/mdb:applicationSchemaInfo" or="applicationSchemaInfo"
                     in="/mdb:MD_Metadata"/>
         </tab>
    </view>

    <view name="xml" displayIfServiceInfo="count(session[profile='Administrator'])=1">
         <tab id="xml" default="true"/>
    </view>
  </views>
</editor>
